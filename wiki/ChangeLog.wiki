#summary 版本更新日志

= 1.6 =
2013-01-08发布。

 * 新增：提供了BuguEntity接口的简单实现类SimpleEntity，方便简化代码。
 * 新增：可以指定ID的类型，包括：自动产生、自动增长、用户自定义。
 * 新增：@Ref和@RefList注解新增manual属性，用以指定使用Manual Reference还是DBRef。
 * 新增：支持mongodb 2.2新增的new aggregation框架。
 * 新增：支持mongodb 2.2新增的TTL collection。
 * 新增：新增@IndexEmbedBy注解。
 * 新增：支持集群环境下的Lucene索引和搜索。
 * 改进：完善了BuguDao的泛型参数。
 * 改进：完善了AdvancedDao的功能和异常信息。
 * 改进：drop某个collection的时候，能自动drop其相应的数据库索引。
 * 改进：若干代码重构与性能优化。
 * 解决bug：重建索引时，分页查询不正确。（感谢网友Never88Gone的反馈）
 * 变更：MongoDB Java Driver版本更新到2.10  

= 1.4 =
2012-06-29发布。

 * 变更：把Query重命名为BuguQuery，以便统一和区分。
 * 变更：BuguFS不再使用单例模式，而是用new()创建对象。
 * 改进：把BuguSearcher的返回结果List中的null值排除。
 * 改进：修改了上传到GridFS中的文件名的产生方式，以便在高并发的情况下也可确保文件名的唯一性。
 * 改进：提高了图片压缩的清晰度。
 * 改进：完善了几个地方的异常信息。
 * 新增功能：可以设置文件存储的bucketName和chunkSize。
 * 解决bug：IndexWriter和IndexSearcher初始化的时候，在多线程环境下出错。
 * 解决bug：调用FieldUtil.get()方法时可能出现空指针异常。
 * MongoDB Java Driver版本更新到2.8.0

= 1.2 =
2012-03-17发布。

 * BuguDao新增unset()系列方法，用于删除某一列。
 * BuguMapper新增一个toDBRef(Class<?> clazz, String idStr)方法。
 * BuguParser新增一个方法parseTerm(String field, String value)。
 * 新增功能：可以设置Lucene Index的RAM Buffer Size。
 * BuguConnection新增close()方法，用于释放资源。
 * 改进了log4j的日志格式，详细记录了异常信息。 (感谢网友wendal1985的建议)
 * 改进：Dao和Query增加了对泛型的支持。(感谢网友wendal1985的建议)
 * 改进：关闭程序的时候，如果出现异常，Lucene索引没有解锁，则能够自动解锁。
 * 改进：一个entity本身可以不创建lucene索引，但某些属性可以被其它索引引用。
 * 改进：如果@IndexRefBy标注的属性只是@Id属性，则entity被修改的时候，Lucene索引不需要同步更新。
 * 解决bug：toDBRef()方法中当entity的id不符合规范时出错。
 * 解决bug：max()和min()函数在collection为空的情况下出错。
 * 解决bug：Lucene搜索的高亮显示，在没有关键词相匹配的时候出错。
 * 解决bug：BuguMapper的fetchCascade()和fetchLazy()方法当entity为null时出错。


= 1.0 =
2011-12-14发布。

 * @EmbedList和@RefList增加了对数组的支持。
 * 新增@IndexEmbedList和@IndexRefList注解，支持集合属性的Lucene索引和搜索。 
 * 新增@IndexRefBy注解。 
 * @EnsureIndex中的index属性改为value。
 * @EnsureIndex注解增加了对name、unique、background等索引参数的支持。
 * @Property、@Embed、@EmbedList等注解增加了lazy属性，用于提高查询性能。 
 * BuguMapper类新增一个fetchLazy()方法，用于获取@Property、@Embed、@EmbedList等lazy属性。 
 * 删除了@Ref、@RefList的lazy属性，改用cascade。
 * @Ref、@RefList新增cascade属性。
 * 把BuguMapper中原来的两个fetch()方法更名为fetchCascade()。
 * 鉴于BuguDao中原有的update方法难以理解和使用，全部改为set方法。
 * 解决bug：重建Lucene索引之前没有删除原来的索引。
 * 解决bug：MapperUtil中的hasIndexAnnotation()方法，当key中有“."的时候出错。
 * 解决bug：Query查询时，当key中有“.”的时候出错。
 * 解决bug：@Property对Long、Double、Float、Short等对象的数据转换出错。
 * 用Query、Map替换DBObject，增强API的易用性。
 * 把Lucene索引默认更新周期改为30秒。
 * 增加了对ReadPreference的支持。
 * MongoDB Java Driver版本更新到2.7.2。
 * Lucene版本更新到3.5.0。


= 0.8 =
2011-10-19发布。

 * BuguConnection增加了对副本集(Replica Set)以及MongoOptions的支持。
 * BuguConnection和BuguSearcher等需要设置多个参数的地方，支持连缀书写形式。
 * BuguDao新增批量删除的方法。
 * 新增一个AdvancedDao类，将BuguDao中较少用到的高级功能(主要是MapReduce)移入其中。
 * 在AdvancedDao中增加了对group聚合函数的支持。
 * 新增一个Query类，用于更方便的实现查询。
 * 修改了@EnsureIndex注解中属性的规则，使其更容易使用。
 * @EnsureIndex增加了对地理空间数据索引的支持。
 * 增强了BuguParser的功能，解析字符串的时候，能设置Operator.AND或Operator.OR。
 * Uploader新增2个构造函数，用于保存byte[]和InputStream类型的数据。
 * ImageUploader新增getSize()方法，获取图片的宽度和高度。
 * 修正了图片压缩、加水印时可能出错的bug。
 * MongoDB Java Driver版本更新到2.6.5。
 * Lucene版本更新到3.4.0。


= 0.6 =
2011-09-15发布。

 * BuguConnection新增一个connect()方法，用于在不需要提供授权帐号的情况下连接数据库。
 * 增加了对short、Timestamp数据类型的支持。
 * 新增@EnsureIndex注解，用来建立数据库索引。
 * BuguDao新增getCollection()方法，用于获取DBCollection。
 * BuguDao新增drop()方法，用于删除Collection。
 * 解决了MapReduce中排序属性orderBy不能为null的bug。
 * BuguFS新增文件夹的概念，可以按文件夹来组织文件。
 * BuguFS可以对文件夹、文件进行重命名。
 * BuguFS可以将文件在文件夹之间移动。
 * BuguFS取出文件列表的时候，可以排序和分页。
 * 解决IndexReader在reopen之后没有释放的bug。
 * BuguSearcher新增close()方法，以关闭相应的IndexReader。
 * Lucene搜索增加了对高亮显示（Highlighter）的支持。
 * 把BuguIndex的线程池默认值由5改为10。
 * 对部分代码的性能进行了优化。


= 0.4 =
2011-08-20发布。

 * ODM增加了对Map数据类型的支持。
 * @RefList注解增加了sort属性，用于排序。
 * BuguDao中的排序，增加了对形如"level:1, name:-1"这样的多个排序属性的支持。
 * BuguDao中新增max()、min()、sum()等统计函数，并增强了mapReduce函数的功能。
 * 优化了BuguDao批量插入的性能。
 * 修正了IndexRebuildTask中批量处理的bug。
 * 修正了BuguFS中保存文件时附加属性的bug。
 * 增加了UploadedFileServlet对浏览器中支持文件的类型，包括html、htm、swf、mp3、mp4、pdf等。


= 0.2 =
2011-07-30发布